<div class="announcement-bar-wrapper"
     style="--announcement-bg-color: {{ section.settings.background_color }};
            --announcement-text-color: {{ section.settings.text_color }};
            --announcement-link-color: {{ section.settings.link_text_color }};">

  {%- assign announcement_block_count = section.blocks | size -%}

  {% if announcement_block_count > 0 %}
    <div class="announcement-bar" style="background-color: var(--announcement-bg-color); color: var(--announcement-text-color);">
      <div class="page-width">
        <div class="slideshow-wrapper">

          <button type="button" class="visually-hidden slideshow__pause" data-id="{{ section.id }}" aria-live="polite">
            <span class="slideshow__pause-stop">
              <svg aria-hidden="true" focusable="false" role="presentation" class="icon icon-pause" viewBox="0 0 10 13"><path d="M0 0h3v13H0zm7 0h3v13H7z" fill-rule="evenodd"/></svg>
            </span>
            <span class="slideshow__pause-play">
              <svg aria-hidden="true" focusable="false" role="presentation" class="icon icon-play" viewBox="18.24 17.35 24.52 28.3"><path fill="#323232" d="M22.1 19.151v25.5l20.4-13.489-20.4-12.011z"/></svg>
            </span>
          </button>

          <div id="AnnouncementSlider"
               class="announcement-slider"
               data-compact="{{ section.settings.announcement_compact }}"
               data-block-count="{{ announcement_block_count }}">

            {%- assign slide_index = 0 -%}
            {%- for block in section.blocks -%}
              {%- if block.type == 'announcement_by_rusho' -%}

                <div id="AnnouncementSlide-{{ block.id }}"
                     class="announcement-slider__slide"
                     data-index="{{ slide_index }}"
                     {{ block.shopify_attributes }}>

                  {% if block.settings.link != blank %}
                    <a class="announcement-link" href="{{ block.settings.link }}" style="color: var(--announcement-link-color);">
                  {% endif %}

                  {% if block.settings.text != blank %}
                    <span class="announcement-text">{{ block.settings.text }}</span>
                  {% endif %}
                  
                  {% if block.settings.link_text != blank %}
                    <span class="announcement-link-text">{{ block.settings.link_text }}</span>
                  {% endif %}

                  {% if block.settings.link != blank %}</a>{% endif %}
                </div>

                {%- assign slide_index = slide_index | plus: 1 -%}
              {%- endif -%}
            {%- endfor -%}

          </div>
        </div>
      </div>
    </div>
  {% endif %}

</div>

{% schema %}
{
  "name": "Announcement by Rusho",
  "settings": [
    {
      "type": "checkbox",
      "id": "announcement_compact",
      "label": "Compact slider",
      "default": false
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#f5f5f5"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "link_text_color",
      "label": "Link text color",
      "default": "#1a73e8"
    }
  ],
  "blocks": [
    {
      "type": "announcement_by_rusho",
      "name": "Announcement by Rusho",
      "limit": 5,
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Hassle-free returns"
        },
        {
          "type": "text",
          "id": "link_text",
          "label": "Link text",
          "default": "30-day postage paid returns"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link URL"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Announcement by Rusho",
      "category": "Header",
      "blocks": [
        {
          "type": "announcement_by_rusho",
          "settings": {}
        }
      ]
    }
  ]
}
{% endschema %}